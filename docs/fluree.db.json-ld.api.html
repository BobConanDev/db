<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>fluree.db.json-ld.api documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">com.fluree/db</span> <span class="project-version">3.0.0-alpha1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="fluree.db.json-ld.api.html"><div class="inner"><span>fluree.db.json-ld.api</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-address.3F"><div class="inner"><span>address?</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-alias-.3Eaddress"><div class="inner"><span>alias-&gt;address</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-branch"><div class="inner"><span>branch</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-combine"><div class="inner"><span>combine</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-commit.21"><div class="inner"><span>commit!</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-connect"><div class="inner"><span>connect</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-connect-ipfs"><div class="inner"><span>connect-ipfs</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-connect-memory"><div class="inner"><span>connect-memory</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-create"><div class="inner"><span>create</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-db"><div class="inner"><span>db</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-default-context"><div class="inner"><span>default-context</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-default-context-at-t"><div class="inner"><span>default-context-at-t</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-exists.3F"><div class="inner"><span>exists?</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-expand-iri"><div class="inner"><span>expand-iri</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-history"><div class="inner"><span>history</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-index"><div class="inner"><span>index</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-internal-id"><div class="inner"><span>internal-id</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-load"><div class="inner"><span>load</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-load-from-address"><div class="inner"><span>load-from-address</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-merge"><div class="inner"><span>merge</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-multi-query"><div class="inner"><span>multi-query</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-promise-wrap"><div class="inner"><span>promise-wrap</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-pull"><div class="inner"><span>pull</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-push"><div class="inner"><span>push</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-query"><div class="inner"><span>query</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-range"><div class="inner"><span>range</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-slice"><div class="inner"><span>slice</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-squash"><div class="inner"><span>squash</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-stage"><div class="inner"><span>stage</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-status"><div class="inner"><span>status</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-transact.21"><div class="inner"><span>transact!</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-update-default-context"><div class="inner"><span>update-default-context</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-validate"><div class="inner"><span>validate</span></div></a></li><li class="depth-1"><a href="fluree.db.json-ld.api.html#var-wrap-policy"><div class="inner"><span>wrap-policy</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">fluree.db.json-ld.api</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-address.3F"><h3>address?</h3><div class="usage"><code>(address? ledger-alias-or-address)</code></div><div class="doc"><pre class="plaintext">Returns true if the argument is a full ledger address, false if it is just an
alias.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L91">view source</a></div></div><div class="public anchor" id="var-alias-.3Eaddress"><h3>alias-&gt;address</h3><div class="usage"><code>(alias-&gt;address conn ledger-alias)</code></div><div class="doc"><pre class="plaintext">Returns a core.async channel with the connection-specific address of the
given ledger-alias.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L138">view source</a></div></div><div class="public anchor" id="var-branch"><h3>branch</h3><div class="usage"><code>(branch)</code></div><div class="doc"><pre class="plaintext">Creates a new branch of a given ledger
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L265">view source</a></div></div><div class="public anchor" id="var-combine"><h3>combine</h3><div class="usage"><code>(combine)</code></div><div class="doc"><pre class="plaintext">Combines multiple ledgers into a new, read-only ledger.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L205">view source</a></div></div><div class="public anchor" id="var-commit.21"><h3>commit!</h3><div class="usage"><code>(commit! ledger db)</code><code>(commit! ledger db opts)</code></div><div class="doc"><pre class="plaintext">Commits a staged database to the ledger with all changes since the last commit
aggregated together.

Commits are tracked in the local environment, but if the ledger is distributed
it will still need a 'push' to ensure it is published and verified as per the
distributed rules.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L220">view source</a></div></div><div class="public anchor" id="var-connect"><h3>connect</h3><div class="usage"><code>(connect {:keys [method parallelism], :as opts})</code></div><div class="doc"><pre class="plaintext">Forms connection to ledger, enabling automatic pulls of new updates, event
services, index service.

Multiple connections to same endpoint will share underlying network connection.

Options include:
  - did - (optional) DiD information to use, if storing blocks as verifiable credentials,
          or issuing queries against a permissioned database.
  - context - (optional) Default @context map to use for ledgers formed with this connection.
  - write - (optional) Function to use for all writes, if empty will store in memory until a commit is performed
  - read - (optional) Function to use for reads of persisted blocks/data
  - commit - (optional) Function to use to write commits. If persistence desired, this must be defined
  - push - (optional) Function(s) in a vector that will attempt to push the commit to naming service(s)
  </pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L45">view source</a></div></div><div class="public anchor" id="var-connect-ipfs"><h3>connect-ipfs</h3><div class="usage"><code>(connect-ipfs opts)</code></div><div class="doc"><pre class="plaintext">Forms an ipfs connection using default settings.
- server - (optional) IPFS http api server endpoint, defaults to <a href="http://127.0.0.1:5001/">http://127.0.0.1:5001/</a>
- profile - (optional) IPFS stored profile to use.
- did - (optional) DiD information to use, if storing blocks as verifiable credentials
- context - (optional) Default @context map to use for ledgers formed with this connection.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L75">view source</a></div></div><div class="public anchor" id="var-connect-memory"><h3>connect-memory</h3><div class="usage"><code>(connect-memory opts)</code></div><div class="doc"><pre class="plaintext">Forms an in-memory connection using default settings.
- did - (optional) DiD information to use, if storing blocks as verifiable credentials
- context - (optional) Default @context map to use for ledgers formed with this connection.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L84">view source</a></div></div><div class="public anchor" id="var-create"><h3>create</h3><div class="usage"><code>(create conn)</code><code>(create conn ledger-alias)</code><code>(create conn ledger-alias opts)</code></div><div class="doc"><pre class="plaintext">Creates a new json-ld ledger. A connection (conn)
must always be supplied.

Ledger-name (optional) is a friendly name that is used for:
- When publishing to a naming service that allows multiple pointers for the
  same namespace (e.g. IPNS), this becomes a sub-directory off the namespace.
  For multple directories deep, use '/' for a
  e.g. the ledgers movies/popular, books/authors, books/best-sellers could
  use the same IPNS id (in this example using IPNS DNSLink):
  fluree:ipns://my.dns.com/books/authors
  fluree:ipns://my.dns.com/books/best-sellers
  fluree:ipns://my.dns.com/movies/top-rated
- When combining multiple ledgers, each ledger becomes an individual named
  graph which can be referenced by name.

Options map (opts) can include:
- did - DiD information to use, if storing blocks as verifiable credentials
- context - Default @context map to use for ledgers formed with this connection
  </pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L97">view source</a></div></div><div class="public anchor" id="var-db"><h3>db</h3><div class="usage"><code>(db ledger)</code><code>(db ledger opts)</code></div><div class="doc"><pre class="plaintext">Retrieves latest db, or optionally a db at a moment in time
and/or permissioned to a specific identity.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L272">view source</a></div></div><div class="public anchor" id="var-default-context"><h3>default-context</h3><div class="usage"><code>(default-context db)</code></div><div class="doc"><pre class="plaintext">Returns the current default context set on the db.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L167">view source</a></div></div><div class="public anchor" id="var-default-context-at-t"><h3>default-context-at-t</h3><div class="usage"><code>(default-context-at-t ledger t)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L172">view source</a></div></div><div class="public anchor" id="var-exists.3F"><h3>exists?</h3><div class="usage"><code>(exists? conn ledger-alias-or-address)</code></div><div class="doc"><pre class="plaintext">Returns a promise with true if the ledger alias or address exists, false
otherwise.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L155">view source</a></div></div><div class="public anchor" id="var-expand-iri"><h3>expand-iri</h3><div class="usage"><code>(expand-iri db compact-iri)</code><code>(expand-iri db compact-iri context)</code></div><div class="doc"><pre class="plaintext">Expands given IRI with the default database context, or provided context.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L330">view source</a></div></div><div class="public anchor" id="var-history"><h3>history</h3><div class="usage"><code>(history ledger query)</code></div><div class="doc"><pre class="plaintext">Return the change history over a specified time range. Optionally include the commit
that produced the changes.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L305">view source</a></div></div><div class="public anchor" id="var-index"><h3>index</h3><div class="usage"><code>(index ledger)</code></div><div class="doc"><pre class="plaintext">Performs indexing operation on the specified ledger
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L187">view source</a></div></div><div class="public anchor" id="var-internal-id"><h3>internal-id</h3><div class="usage"><code>(internal-id db iri)</code></div><div class="doc"><pre class="plaintext">Returns the internal Fluree integer id for a given IRI.
This can be used for doing range scans, slices and for other
more advanced needs.

Returns promise</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L337">view source</a></div></div><div class="public anchor" id="var-load"><h3>load</h3><div class="usage"><code>(load conn ledger-alias)</code></div><div class="doc"><pre class="plaintext">Loads an existing ledger by its alias (which will be converted to a
connection-specific address first).</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L145">view source</a></div></div><div class="public anchor" id="var-load-from-address"><h3>load-from-address</h3><div class="usage"><code>(load-from-address address)</code><code>(load-from-address conn address)</code></div><div class="doc"><pre class="plaintext">Loads a ledger defined with a Fluree address, e.g.:
fluree:ipfs://Qmaq4ip1bJq6255S5PhU8veo6gxaq2yyucKZmJkV1WW8YG
fluree:ipns://k51qzi5uqu5dljuijgifuqz9lt1r45lmlnvmu3xzjew9v8oafoqb122jov0mr2
fluree:ipns://my.dns.com/movies/top-rated
fluree:<a href="file://my/db">file://my/db</a>
fluree:s3:....</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L123">view source</a></div></div><div class="public anchor" id="var-merge"><h3>merge</h3><div class="usage"><code>(merge)</code></div><div class="doc"><pre class="plaintext">Merges changes from one branch into another branch.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L259">view source</a></div></div><div class="public anchor" id="var-multi-query"><h3>multi-query</h3><div class="usage"><code>(multi-query db multi-query)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L299">view source</a></div></div><div class="public anchor" id="var-promise-wrap"><h3>promise-wrap</h3><div class="usage"><code>(promise-wrap port)</code></div><div class="doc"><pre class="plaintext">Wraps an async channel that will contain a response in a promise.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L23">view source</a></div></div><div class="public anchor" id="var-pull"><h3>pull</h3><div class="usage"><code>(pull)</code></div><div class="doc"><pre class="plaintext">Checks name service for ledger and pulls latest version locally.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L199">view source</a></div></div><div class="public anchor" id="var-push"><h3>push</h3><div class="usage"><code>(push)</code></div><div class="doc"><pre class="plaintext">Pushes all commits since last push to a naming service, e.g. a Fluree Network, IPNS, DNS, Fluree Nexus.
Depending on consensus requirements for a Fluree Network, will accept or reject push as newest update.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L246">view source</a></div></div><div class="public anchor" id="var-query"><h3>query</h3><div class="usage"><code>(query db query)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L295">view source</a></div></div><div class="public anchor" id="var-range"><h3>range</h3><div class="usage"><code>(range db index test match)</code><code>(range db index start-test start-match end-test end-match)</code></div><div class="doc"><pre class="plaintext">Performs a range scan against the specified index using test functions
of &gt;=, &lt;=, &gt;, &lt;</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L313">view source</a></div></div><div class="public anchor" id="var-slice"><h3>slice</h3><div class="usage"><code>(slice db index match)</code></div><div class="doc"><pre class="plaintext">Like range, but returns all flakes that match the supplied flake parts.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L324">view source</a></div></div><div class="public anchor" id="var-squash"><h3>squash</h3><div class="usage"><code>(squash)</code></div><div class="doc"><pre class="plaintext">Squashes multiple unpublished commits into a single unpublished commit
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L253">view source</a></div></div><div class="public anchor" id="var-stage"><h3>stage</h3><div class="usage"><code>(stage db json-ld)</code><code>(stage db json-ld opts)</code></div><div class="doc"><pre class="plaintext">Performs a transaction and queues change if valid (does not commit)
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L212">view source</a></div></div><div class="public anchor" id="var-status"><h3>status</h3><div class="usage"><code>(status ledger)</code><code>(status ledger branch)</code></div><div class="doc"><pre class="plaintext">Returns current status of ledger branch.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L240">view source</a></div></div><div class="public anchor" id="var-transact.21"><h3>transact!</h3><div class="usage"><code>(transact! ledger json-ld opts)</code></div><div class="doc"><pre class="plaintext">Stages and commits the transaction `json-ld` to the specified `ledger`
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L234">view source</a></div></div><div class="public anchor" id="var-update-default-context"><h3>update-default-context</h3><div class="usage"><code>(update-default-context db default-context)</code></div><div class="doc"><pre class="plaintext">Updates the default context on a given database.
Currently, the updated default context will only be
written with a new commit, which requires staging
changed data.

Returns an updated db.</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L176">view source</a></div></div><div class="public anchor" id="var-validate"><h3>validate</h3><div class="usage"><code>(validate)</code></div><div class="doc"><pre class="plaintext">Validates a ledger, checks block integrity along with signatures.
</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L193">view source</a></div></div><div class="public anchor" id="var-wrap-policy"><h3>wrap-policy</h3><div class="usage"><code>(wrap-policy db identity-map)</code></div><div class="doc"><pre class="plaintext">Wraps a db object with specified permission attributes.
When requesting a db from a ledger, permission attributes can
be requested at that point, however if one has a db already, this
allows the permission attributes to be modified.

Returns promise</pre></div><div class="src-link"><a href="https://github.com/fluree/db/blob/v3.0.0-alpha1/src/fluree/db/json_ld/api.cljc#L283">view source</a></div></div></div></body></html>